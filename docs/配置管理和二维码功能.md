# é…ç½®ç®¡ç†å’ŒäºŒç»´ç åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

æ–°å¢äº†æˆ¿é—´é…ç½®ç®¡ç†å’ŒäºŒç»´ç åŠ å…¥åŠŸèƒ½ï¼Œè®©æˆ¿é—´ç®¡ç†æ›´åŠ çµæ´»å’Œä¾¿æ·ã€‚

## ğŸ¯ ä¸»è¦åŠŸèƒ½

### 1. æˆ¿é—´é…ç½®ç®¡ç†

#### åŠŸèƒ½è¯´æ˜
- æˆ¿é—´ç®¡ç†å‘˜å¯ä»¥å‘å¸ƒJSONæ ¼å¼çš„é…ç½®
- é…ç½®ä¼šå®æ—¶å¹¿æ’­ç»™æˆ¿é—´å†…æ‰€æœ‰æˆå‘˜
- æ¯æ¬¡å‘å¸ƒæ–°é…ç½®æ—¶ï¼Œæ—§é…ç½®ä¼šè¢«æ›¿æ¢
- é…ç½®æ”¯æŒç‰ˆæœ¬ç®¡ç†

#### ä½¿ç”¨åœºæ™¯
- æ¸¸æˆæˆ¿é—´è®¾ç½®ï¼ˆéš¾åº¦ã€æ¨¡å¼ç­‰ï¼‰
- åä½œå·¥å…·é…ç½®ï¼ˆæƒé™ã€è®¾ç½®ç­‰ï¼‰
- æ•°æ®æ¨¡æ¿åˆ†å‘
- è§„åˆ™å’Œè®¾ç½®å…±äº«

### 2. äºŒç»´ç åŠ å…¥æˆ¿é—´

#### åŠŸèƒ½è¯´æ˜
- åˆ›å»ºæˆ¿é—´åè‡ªåŠ¨ç”ŸæˆäºŒç»´ç 
- æ‰«æäºŒç»´ç å³å¯åŠ å…¥æˆ¿é—´
- åŠ å…¥åè‡ªåŠ¨æ¥æ”¶æœ€æ–°é…ç½®
- æ”¯æŒå¤šç§æ ¼å¼ï¼ˆPNGã€SVGã€Data URLï¼‰

#### ä½¿ç”¨åœºæ™¯
- æ‰‹æœºå¿«é€ŸåŠ å…¥
- åˆ†äº«æˆ¿é—´é“¾æ¥
- çº¿ä¸‹æ´»åŠ¨ç»„ç»‡
- å¿«é€Ÿé‚€è¯·æˆå‘˜

## ğŸ“š API æ–‡æ¡£

### WebSocket æ¶ˆæ¯ç±»å‹

#### 1. publish_config - å‘å¸ƒé…ç½®ï¼ˆä»…ç®¡ç†å‘˜ï¼‰

**å‘é€**:
```json
{
  "type": "publish_config",
  "data": {
    "config": {
      "title": "ç¤ºä¾‹é…ç½®",
      "settings": {
        "value": 123,
        "enabled": true
      }
    }
  }
}
```

**å“åº”**:
```json
{
  "type": "publish_config",
  "data": {
    "success": true,
    "version": 1
  }
}
```

#### 2. get_config - è·å–å½“å‰é…ç½®

**å‘é€**:
```json
{
  "type": "get_config",
  "data": {}
}
```

**å“åº”**:
```json
{
  "type": "get_config",
  "data": {
    "config": {
      "title": "ç¤ºä¾‹é…ç½®",
      "settings": {}
    },
    "version": 1
  }
}
```

#### 3. config_update - é…ç½®æ›´æ–°æ¨é€

å½“æœ‰æ–°é…ç½®å‘å¸ƒæ—¶ï¼Œæ‰€æœ‰æˆå‘˜éƒ½ä¼šæ”¶åˆ°ï¼š

```json
{
  "type": "config_update",
  "data": {
    "config": {
      "title": "æ–°é…ç½®",
      "settings": {}
    },
    "version": 2
  }
}
```

#### 4. å¹¿æ’­äº‹ä»¶ - config_published

```json
{
  "type": "broadcast",
  "data": {
    "event": "config_published",
    "config": {},
    "version": 1,
    "timestamp": 1234567890
  }
}
```

### HTTP API

#### ç”ŸæˆäºŒç»´ç 

**è¯·æ±‚**:
```
GET /api/rooms/:roomId/qrcode?format=data
```

**å‚æ•°**:
- `roomId`: æˆ¿é—´å·
- `format`: æ ¼å¼
  - `png`: PNGå›¾ç‰‡ï¼ˆé»˜è®¤ï¼‰
  - `svg`: SVGå›¾ç‰‡
  - `data`: Data URLï¼ˆJSONå“åº”ï¼‰

**å“åº”ï¼ˆformat=dataï¼‰**:
```json
{
  "success": true,
  "data": {
    "dataUrl": "data:image/png;base64,...",
    "roomId": "ABC123",
    "joinUrl": "http://localhost:3000/join?roomId=ABC123"
  }
}
```

**å“åº”ï¼ˆformat=pngï¼‰**:
è¿”å›PNGå›¾ç‰‡ï¼ˆContent-Type: image/pngï¼‰

**å“åº”ï¼ˆformat=svgï¼‰**:
è¿”å›SVGå›¾ç‰‡ï¼ˆContent-Type: image/svg+xmlï¼‰

## ğŸ’» å‰ç«¯ä½¿ç”¨ç¤ºä¾‹

### 1. æ‰“å¼€é…ç½®ç¼–è¾‘å™¨

ç®¡ç†å‘˜åœ¨èŠå¤©ç•Œé¢ç‚¹å‡» **"âš™ï¸ é…ç½®"** æŒ‰é’®ï¼š

```javascript
function openConfigEditor() {
    // æ‰“å¼€é…ç½®ç¼–è¾‘å™¨æ¨¡æ€æ¡†
    // åŠ è½½å½“å‰é…ç½®æˆ–æ˜¾ç¤ºé»˜è®¤æ¨¡æ¿
}
```

### 2. ç¼–è¾‘å’Œå‘å¸ƒé…ç½®

åœ¨é…ç½®ç¼–è¾‘å™¨ä¸­è¾“å…¥JSONï¼š

```json
{
  "gameMode": "competitive",
  "maxScore": 100,
  "timeLimit": 600,
  "rules": {
    "friendly_fire": false,
    "respawn": true
  }
}
```

ç‚¹å‡» **"å‘å¸ƒé…ç½®"** æŒ‰é’®ï¼Œé…ç½®ä¼šï¼š
1. éªŒè¯JSONæ ¼å¼
2. å‘é€åˆ°æœåŠ¡å™¨
3. å¹¿æ’­ç»™æ‰€æœ‰æˆå‘˜
4. æ›´æ–°ç‰ˆæœ¬å·

### 3. æ˜¾ç¤ºäºŒç»´ç 

ç®¡ç†å‘˜ç‚¹å‡» **"ğŸ“± äºŒç»´ç "** æŒ‰é’®ï¼š

```javascript
function showQRCode() {
    // ä»APIè·å–äºŒç»´ç 
    // æ˜¾ç¤ºåœ¨æ¨¡æ€æ¡†ä¸­
}
```

### 4. æ‰«ç åŠ å…¥

å…¶ä»–ç”¨æˆ·æ‰«æäºŒç»´ç åï¼š
1. è·å–æˆ¿é—´å·
2. è‡ªåŠ¨æ‰“å¼€åŠ å…¥é¡µé¢
3. URLæ ¼å¼ï¼š`http://localhost:3000/join?roomId=ABC123`
4. é¡µé¢è‡ªåŠ¨è¿æ¥å¹¶åŠ å…¥æˆ¿é—´
5. è‡ªåŠ¨æ¥æ”¶æœ€æ–°é…ç½®

### 5. ç›‘å¬é…ç½®æ›´æ–°

```javascript
ws.onmessage = (event) => {
    const message = JSON.parse(event.data);
    
    if (message.type === 'config_update') {
        const config = message.data.config;
        const version = message.data.version;
        
        console.log('æ”¶åˆ°æ–°é…ç½®:', config);
        console.log('ç‰ˆæœ¬:', version);
        
        // åº”ç”¨é…ç½®åˆ°ä½ çš„åº”ç”¨
        applyConfig(config);
    }
};
```

## ğŸ¨ UI ç•Œé¢

### é…ç½®ç¼–è¾‘å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ æˆ¿é—´é…ç½®ç¼–è¾‘å™¨              Ã— â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  {                                  â”‚
â”‚    "title": "æˆ‘çš„é…ç½®",            â”‚
â”‚    "settings": {                    â”‚
â”‚      "value": 123                   â”‚
â”‚    }                                â”‚
â”‚  }                                  â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç‰ˆæœ¬: 1        [å–æ¶ˆ]  [å‘å¸ƒé…ç½®]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äºŒç»´ç æ˜¾ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ğŸ“± æ‰«ç åŠ å…¥æˆ¿é—´               â”‚
â”‚     æˆ¿é—´å·: ABC123                  â”‚
â”‚                                     â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚       â”‚  QR Code    â”‚               â”‚
â”‚       â”‚   Image     â”‚               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                     â”‚
â”‚          [å…³é—­]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç®¡ç†å‘˜æŒ‰é’®

ç®¡ç†å‘˜åœ¨èŠå¤©ç•Œé¢ä¼šçœ‹åˆ°é¢å¤–çš„æŒ‰é’®ï¼š

```
æˆ¿é—´: ABC123 (ç®¡ç†å‘˜)
5 äººåœ¨çº¿ Â· admin
[ğŸ“± äºŒç»´ç ] [âš™ï¸ é…ç½®] [æˆ¿é—´ä¿¡æ¯] [ç¦»å¼€æˆ¿é—´]
```

## ğŸ”„ å·¥ä½œæµç¨‹

### å‘å¸ƒé…ç½®æµç¨‹

```
1. ç®¡ç†å‘˜æ‰“å¼€é…ç½®ç¼–è¾‘å™¨
   â†“
2. ç¼–è¾‘JSONé…ç½®
   â†“
3. ç‚¹å‡»"å‘å¸ƒé…ç½®"
   â†“
4. å®¢æˆ·ç«¯éªŒè¯JSONæ ¼å¼
   â†“
5. å‘é€ publish_config æ¶ˆæ¯
   â†“
6. æœåŠ¡å™¨éªŒè¯æƒé™
   â†“
7. æ›´æ–°æˆ¿é—´é…ç½®å’Œç‰ˆæœ¬å·
   â†“
8. å¹¿æ’­ç»™æ‰€æœ‰æˆå‘˜
   â†“
9. æ‰€æœ‰æˆå‘˜æ”¶åˆ° config_update
   â†“
10. åº”ç”¨æ–°é…ç½®
```

### äºŒç»´ç åŠ å…¥æµç¨‹

```
1. ç®¡ç†å‘˜åˆ›å»ºæˆ¿é—´
   â†“
2. ç‚¹å‡»"äºŒç»´ç "æŒ‰é’®
   â†“
3. æœåŠ¡å™¨ç”ŸæˆäºŒç»´ç 
   â†“
4. æ˜¾ç¤ºäºŒç»´ç 
   â†“
5. æ–°ç”¨æˆ·æ‰«æäºŒç»´ç 
   â†“
6. æ‰“å¼€åŠ å…¥é¡µé¢ï¼ˆå«æˆ¿é—´å·ï¼‰
   â†“
7. è‡ªåŠ¨è¿æ¥æœåŠ¡å™¨
   â†“
8. è‡ªåŠ¨åŠ å…¥æˆ¿é—´
   â†“
9. æ¥æ”¶æœ€æ–°é…ç½®
   â†“
10. å¼€å§‹èŠå¤©
```

## ğŸ› ï¸ åç«¯å®ç°

### RoomManager æ–°å¢æ–¹æ³•

```javascript
// å‘å¸ƒé…ç½®ï¼ˆä»…ç®¡ç†å‘˜ï¼‰
publishConfig(adminClientId, configData)

// è·å–æˆ¿é—´é…ç½®
getRoomConfig(roomId)
```

### WebSocketServer æ–°å¢å¤„ç†å™¨

```javascript
// å¤„ç†å‘å¸ƒé…ç½®
handlePublishConfig(client, data)

// å¤„ç†è·å–é…ç½®
handleGetConfig(client)
```

### API è·¯ç”±

```javascript
// ç”ŸæˆäºŒç»´ç 
GET /api/rooms/:roomId/qrcode
```

## ğŸ“ é…ç½®ç¤ºä¾‹

### æ¸¸æˆæˆ¿é—´é…ç½®

```json
{
  "gameType": "battle_royale",
  "maxPlayers": 100,
  "mapSize": "large",
  "settings": {
    "difficulty": "hard",
    "friendly_fire": false,
    "respawn_time": 10
  },
  "rules": [
    "No camping",
    "No teamkilling",
    "Be respectful"
  ]
}
```

### åä½œå·¥å…·é…ç½®

```json
{
  "project": "Website Redesign",
  "deadline": "2025-12-31",
  "team": {
    "lead": "Alice",
    "members": ["Bob", "Charlie"]
  },
  "settings": {
    "auto_save": true,
    "notification": true,
    "theme": "dark"
  }
}
```

### æ•°æ®æ¨¡æ¿é…ç½®

```json
{
  "schema": {
    "name": "string",
    "age": "number",
    "email": "string",
    "active": "boolean"
  },
  "validation": {
    "name": { "required": true, "minLength": 2 },
    "age": { "min": 0, "max": 150 },
    "email": { "required": true, "pattern": "email" }
  }
}
```

## ğŸ”’ å®‰å…¨è€ƒè™‘

### æƒé™éªŒè¯
- åªæœ‰ç®¡ç†å‘˜å¯ä»¥å‘å¸ƒé…ç½®
- æœåŠ¡å™¨ç«¯ä¸¥æ ¼éªŒè¯æƒé™
- éç®¡ç†å‘˜å°è¯•å‘å¸ƒä¼šæ”¶åˆ°é”™è¯¯

### æ•°æ®éªŒè¯
- å®¢æˆ·ç«¯éªŒè¯JSONæ ¼å¼
- æœåŠ¡å™¨éªŒè¯æ•°æ®å®Œæ•´æ€§
- é˜²æ­¢æ¶æ„æ•°æ®æ³¨å…¥

### é…ç½®å¤§å°é™åˆ¶
å»ºè®®é…ç½®å¤§å°ä¸è¶…è¿‡ 100KBï¼Œä»¥ç¡®ä¿ä¼ è¾“æ•ˆç‡ã€‚

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### é…ç½®è®¾è®¡
1. ä½¿ç”¨æ¸…æ™°çš„é”®å
2. ä¿æŒé…ç½®ç»“æ„ç®€å•
3. æ·»åŠ æ³¨é‡Šå­—æ®µè¯´æ˜é…ç½®ç”¨é€”
4. ç‰ˆæœ¬åŒ–é…ç½®ç»“æ„

### äºŒç»´ç ä½¿ç”¨
1. å®šæœŸæ›´æ–°äºŒç»´ç ï¼ˆå¦‚æœéœ€è¦ï¼‰
2. è®¾ç½®æˆ¿é—´å¯†ç å¢åŠ å®‰å…¨æ€§
3. é™åˆ¶æˆ¿é—´äººæ•°é˜²æ­¢æ»¥ç”¨
4. åœ¨äºŒç»´ç è¿‡æœŸå‰é€šçŸ¥ç”¨æˆ·

### æœ€ä½³å®è·µ
1. å‘å¸ƒé…ç½®å‰å…ˆæµ‹è¯•
2. ä¿å­˜é…ç½®å†å²ç‰ˆæœ¬
3. é€šçŸ¥ç”¨æˆ·é…ç½®å˜æ›´
4. æä¾›é…ç½®æ–‡æ¡£

## ğŸ¯ æœªæ¥æ‰©å±•

- [ ] é…ç½®å†å²è®°å½•
- [ ] é…ç½®å›æ»šåŠŸèƒ½
- [ ] é…ç½®æ¨¡æ¿åº“
- [ ] é…ç½®å·®å¼‚å¯¹æ¯”
- [ ] äºŒç»´ç è¿‡æœŸæ—¶é—´
- [ ] äºŒç»´ç æ‰«æç»Ÿè®¡
- [ ] é…ç½®æƒé™ç»†ç²’åº¦æ§åˆ¶
- [ ] é…ç½®å˜æ›´å®¡æ‰¹æµç¨‹

---

**äº«å—å¼ºå¤§çš„é…ç½®ç®¡ç†åŠŸèƒ½ï¼** ğŸ‰

